apiVersion: external-secrets.io/v1alpha1
kind: PushSecret
metadata:
  name: verdaccio-credentials-push
  namespace: verdaccio
spec:
  refreshInterval: 1h
  secretStoreRefs:
    - name: vault-backend
      kind: ClusterSecretStore
  selector:
    secret:
      name: verdaccio-credentials
  data:
    - match:
        secretKey: htpasswd
        remoteRef:
          remoteKey: applications/developer-platform/verdaccio/app
          property: htpasswd
    - match:
        secretKey: npm-robot-password
        remoteRef:
          remoteKey: applications/developer-platform/verdaccio/app
          property: npm-robot-password
    - match:
        secretKey: npm-robot-username
        remoteRef:
          remoteKey: applications/developer-platform/verdaccio/app
          property: npm-robot-username
    - match:
        secretKey: oauth-cookie-secret
        remoteRef:
          remoteKey: applications/developer-platform/verdaccio/app
          property: oauth-cookie-secret

---
# Global configuration
global:
  repoURL: 'https://github.com/ProficientnowTech/pn-infra.git'
  targetRevision: 'main'

# Labels configuration
labels:
  component: percona-everest
  component-category: database-management
  managed-by: argocd

# Percona Everest Configuration
# Based on: https://docs.percona.com/everest/
everest:
  # Namespace override - Everest requires everest-system namespace
  namespaceOverride: everest-system

  # Disable telemetry
  telemetry: false

  # Server configuration
  server:
    image: percona/everest

    # Resource limits
    resources:
      requests:
        cpu: 100m
        memory: 128Mi
      limits:
        cpu: 500m
        memory: 512Mi

    # Service configuration
    service:
      name: everest
      type: ClusterIP
      port: 8080

    # API rate limiting
    apiRequestsRateLimit: 100

    # RBAC configuration
    rbac:
      enabled: true
      policy: |
        g, admin, role:admin

    # TLS configuration with cert-manager
    tls:
      enabled: true
      secret:
        name: everest-server-tls
      certificate:
        create: true
        domain: everest.pnats.cloud
        additionalHosts:
          - everest.pnats.cloud
        issuer:
          group: cert-manager.io
          kind: ClusterIssuer
          name: letsencrypt-production

  # Ingress configuration
  ingress:
    enabled: true
    ingressClassName: nginx
    annotations:
      # Backend uses HTTPS
      nginx.ingress.kubernetes.io/backend-protocol: "HTTPS"
      nginx.ingress.kubernetes.io/ssl-redirect: "true"
    hosts:
      - host: everest.pnats.cloud
        paths:
          - path: /
            pathType: Prefix
    tls:
      - secretName: everest-server-tls
        hosts:
          - everest.pnats.cloud

  # Compatibility settings
  compatibility:
    openshift: false

  # Hooks configuration
  hooks:
    image: "percona/everest-helmtools:0.0.1"
